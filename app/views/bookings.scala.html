@(bookings: List[models.Booking], cancelBookingForm: Form[controllers.BookingController.CancelBooking])

@styles = {
	<link rel='stylesheet' type='text/css' href='@routes.Assets.at("stylesheets/recommendations.css")'>
}

@scripts = {
	<script type='text/javascript' src='@routes.Assets.at("javascripts/recommendations.js")'></script>
}

@main("FlightPub - Bookings", styles, scripts) {
	<div class="container">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h1 class="panel-title">FlightPub - Bookings</h1>
			</div>

			<div class="panel-body">
				<div class="section-heading">
					<h4>Booking List</h4>
				</div>
				<hr/>
				@if(cancelBookingForm("bookingId").hasErrors) {
					@cancelBookingForm("bookingId").errors.map { error =>
						<div class="alert alert-danger">
							<strong>Error! </strong>
							@error.message
						</div>
					}
				}
				<table id="booking-list" class="table table-striped table-hover table-responsive">
					<tbody>
						@bookings.map { booking =>
							@booking.status match {
								case models.Booking.Status.PENDING => {
									<tr>
										<td>Booking @booking.id</td>
										<td class="text-center">
											<div>Pending</div>
										</td>
										<td>
											<form action="@routes.BookingController.cancel()" method="POST" role="form">
												<input name="@cancelBookingForm("bookingId").name" type="hidden" value="@booking.id"/>
												<input type="submit" class="btn btn-danger btn-xs btn-block" value="Cancel Booking">
											</form>
										</td>
									</tr>
								}
								case models.Booking.Status.AWAITING_RECOMMENDATION_RESPONSE => {
									<tr class="info">
										<td>Booking @booking.id</td>
										<td class="text-center">
											<div class="text-info">Alternative flights available; Please confirm booking choice</div>
										</td>
										<td>
											<a class="btn btn-primary btn-xs btn-block" href="@routes.BookingController.reviewRecommendations(booking.id)">Explore Alternative Flights</a>
											<a class="btn btn-success btn-xs btn-block" href="@* TODO: Configure route for this. *@">Confirm Original Booking</a>
											<form action="@routes.BookingController.cancel()" method="POST" role="form">
												<input name="@cancelBookingForm("bookingId").name" type="hidden" value="@booking.id"/>
												<input type="submit" class="btn btn-danger btn-xs btn-block" value="Cancel Booking">
											</form>
										</td>
									</tr>
								}
								case models.Booking.Status.AWAITING_CONFIRMATION => {
									<tr>
										<td>Booking @booking.id</td>
										<td class="text-center">
											<div>Awaiting travel agent confirmation</div>
										</td>
										<td>
											<form action="@routes.BookingController.cancel()" method="POST" role="form">
												<input name="@cancelBookingForm("bookingId").name" type="hidden" value="@booking.id"/>
												<input type="submit" class="btn btn-danger btn-xs btn-block" value="Cancel Booking">
											</form>
										</td>
									</tr>
								}
								case models.Booking.Status.COMPLETED => {
									<tr class="success">
										<td>Booking @booking.id</td>
										<td class="text-center">
											<div class="text-success">Booking Complete</div>
										</td>
										<td></td>
									</tr>
								}
							}
						}
					</tbody>
				</table>

				<hr/>
				<div class="form-group">
					<a class="btn btn-primary btn-lg col-sm-4 center-block" href="@routes.BookingController.bookings()">Check For Updates</a>
				</div>
			</div>
		</div>
	</div>
}